import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as m}from"./index.B2tizaEh.js";import{H as k,d as E,L as O}from"./index.qmTpIDJh.js";import{M as U,B as r,f as D,e as A,L as z,g as R}from"./static.DO4rtNlp.js";import{G as F,M as P,a as _,I as S,d as B,e as G}from"./index.BVcgrbIe.js";import{f as M}from"./fetchRequest.Dmuu1wXS.js";import{T as H,a as q}from"./index.DJ3CSbw6.js";import"./internal.BEJtFsX8.js";function Z(l){return F({attr:{viewBox:"0 0 32 32"},child:[{tag:"path",attr:{d:"M 16 3 C 12 3 8.4 4.7992187 6 7.6992188 L 6 4 L 4 4 L 4 12 L 12 12 L 12 10 L 6.8007812 10 C 8.8007812 7 12.1 5 16 5 C 22.1 5 27 9.9 27 16 C 27 22.1 22.1 27 16 27 C 9.9 27 5 22.1 5 16 L 3 16 C 3 23.2 8.8 29 16 29 C 23.2 29 29 23.2 29 16 C 29 8.8 23.2 3 16 3 z"},child:[]}]})(l)}function V(l){return F({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,82a46,46,0,1,0,46,46A46.06,46.06,0,0,0,128,82Zm0,80a34,34,0,1,1,34-34A34,34,0,0,1,128,162ZM214,130.84c.06-1.89.06-3.79,0-5.68L229.33,106a6,6,0,0,0,1.11-5.29A105.34,105.34,0,0,0,219.76,74.9a6,6,0,0,0-4.53-3l-24.45-2.71q-1.93-2.07-4-4l-2.72-24.46a6,6,0,0,0-3-4.53,105.65,105.65,0,0,0-25.77-10.66A6,6,0,0,0,150,26.68l-19.2,15.37c-1.89-.06-3.79-.06-5.68,0L106,26.67a6,6,0,0,0-5.29-1.11A105.34,105.34,0,0,0,74.9,36.24a6,6,0,0,0-3,4.53L69.23,65.22q-2.07,1.94-4,4L40.76,72a6,6,0,0,0-4.53,3,105.65,105.65,0,0,0-10.66,25.77A6,6,0,0,0,26.68,106l15.37,19.2c-.06,1.89-.06,3.79,0,5.68L26.67,150.05a6,6,0,0,0-1.11,5.29A105.34,105.34,0,0,0,36.24,181.1a6,6,0,0,0,4.53,3l24.45,2.71q1.94,2.07,4,4L72,215.24a6,6,0,0,0,3,4.53,105.65,105.65,0,0,0,25.77,10.66,6,6,0,0,0,5.29-1.11L125.16,214c1.89.06,3.79.06,5.68,0l19.21,15.38a6,6,0,0,0,3.75,1.31,6.2,6.2,0,0,0,1.54-.2,105.34,105.34,0,0,0,25.76-10.68,6,6,0,0,0,3-4.53l2.71-24.45q2.07-1.93,4-4l24.46-2.72a6,6,0,0,0,4.53-3,105.49,105.49,0,0,0,10.66-25.77,6,6,0,0,0-1.11-5.29Zm-3.1,41.63-23.64,2.63a6,6,0,0,0-3.82,2,75.14,75.14,0,0,1-6.31,6.31,6,6,0,0,0-2,3.82l-2.63,23.63A94.28,94.28,0,0,1,155.14,218l-18.57-14.86a6,6,0,0,0-3.75-1.31h-.36a78.07,78.07,0,0,1-8.92,0,6,6,0,0,0-4.11,1.3L100.87,218a94.13,94.13,0,0,1-17.34-7.17L80.9,187.21a6,6,0,0,0-2-3.82,75.14,75.14,0,0,1-6.31-6.31,6,6,0,0,0-3.82-2l-23.63-2.63A94.28,94.28,0,0,1,38,155.14l14.86-18.57a6,6,0,0,0,1.3-4.11,78.07,78.07,0,0,1,0-8.92,6,6,0,0,0-1.3-4.11L38,100.87a94.13,94.13,0,0,1,7.17-17.34L68.79,80.9a6,6,0,0,0,3.82-2,75.14,75.14,0,0,1,6.31-6.31,6,6,0,0,0,2-3.82l2.63-23.63A94.28,94.28,0,0,1,100.86,38l18.57,14.86a6,6,0,0,0,4.11,1.3,78.07,78.07,0,0,1,8.92,0,6,6,0,0,0,4.11-1.3L155.13,38a94.13,94.13,0,0,1,17.34,7.17l2.63,23.64a6,6,0,0,0,2,3.82,75.14,75.14,0,0,1,6.31,6.31,6,6,0,0,0,3.82,2l23.63,2.63A94.28,94.28,0,0,1,218,100.86l-14.86,18.57a6,6,0,0,0-1.3,4.11,78.07,78.07,0,0,1,0,8.92,6,6,0,0,0,1.3,4.11L218,155.13A94.13,94.13,0,0,1,210.85,172.47Z"},child:[]}]})(l)}function I(l){return F({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"},child:[]},{tag:"path",attr:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0 1 30.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1 0 80 0 40 40 0 1 0-80 0z"},child:[]}]})(l)}function $({setActivatedNewTraceMenu:l,newTraceOptions:i,setNewTraceOptions:d,handleFileSelection2:n}){const v=m.useRef(),x=`Use these parameters to manage the upload process. 
    The 'skip rows' option allows you to skip a specified number of rows at the beginning of the file (e.g., headers), 
    while the 'select column' option lets you choose a specific column to upload when the file contains multiple columns. 
    If no value is specified for the 'select column', the default is 1.`,h=`Use these parameters to specify details about the seismic trace 
    header. Include the station code or name, component code, recording start and end time, and the 
    sampling rate in Hz.`;function p(t){t.preventDefault(),v.current.click()}const f=A.filter(t=>t.category==="file parameters"),o=A.filter(t=>t.category==="seismic parameters");return e.jsxs("div",{className:"flex flex-col py-6 px-4 items-stretch gap-1 absolute start-0 bg-base-200 border border-neutral-500/20 shadow rounded z-50 pt-10 w-72",children:[e.jsxs("div",{className:"mb-2 z-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-start text-sm font-semibold mb-1",children:"File parameters"}),e.jsx("span",{className:"tooltip tooltip-right","data-tip":x,children:e.jsx(I,{})})]}),e.jsx("hr",{className:"border-neutral-500/50 my-2 w-full"})]}),e.jsx("div",{className:"absolute top-1 end-2",children:e.jsx(r,{variant:"ghost",size:"small",onClick:()=>l(!1),toolTipText:"Close the menu.",children:e.jsx(_,{})})}),e.jsx("div",{className:"grid grid-cols-2 gap-2 items-center",children:f.map(t=>e.jsxs("div",{children:[e.jsx(z,{htmlFor:t.id,label:t.label}),e.jsx(S,{className:"input-xs w-full",value:i[t.id],onChange:u=>d({...i,[t.id]:u.target.value}),size:"xs",...t})]},t.id))}),e.jsxs("div",{className:"mt-4 mb-2 z-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-start text-sm font-semibold mb-1 ",children:"Trace header options"}),e.jsx("span",{className:"tooltip tooltip-right","data-tip":h,children:e.jsx(I,{})})]}),e.jsx("hr",{className:"border-neutral-500/50 my-2 w-full"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 items-center",children:o.map(t=>e.jsxs("div",{children:[e.jsx(z,{htmlFor:t.id,label:t.label}),e.jsx(S,{className:"input-xs w-full",value:i[t.id],onChange:u=>d({...i,[t.id]:u.target.value}),size:"xs",...t})]},t.id))}),e.jsx("hr",{className:"border-neutral-500/50 my-2 w-full"}),e.jsxs("div",{className:"flex flex-row items-center justify-center gap-2 mt-4",children:[e.jsx("input",{ref:v,onChange:t=>n(t,"ADD-TRACE"),name:"file",id:"file",type:"file",hidden:!0}),e.jsxs(r,{size:"extra-small",outline:!0,variant:"neutral",toolTipText:"Upload trace data",onClick:p,children:[e.jsx(k,{}),"Upload data"]})]}),e.jsx("p",{className:"text-xs text-center",children:"supported file types: xlsx, csv, txt"})]})}function Q({setActivatedMenuIndex:l,traces:i,backupTraces:d,setTraces:n,setBackupTraces:v,setError:x,setSuccess:h,setLoading:p,traceId:f}){const[o,t]=m.useState(null);async function u(a,j,y){let b=i.map((w,L)=>w.trace_id===a?{...w,stats:{...w.stats,[j]:y}}:w);n(b)}const s=i.find(a=>a.trace_id===f);return e.jsx("form",{onSubmit:a=>handleUpdateHeader(a),children:e.jsxs("div",{className:"flex flex-col p-4 items-stretch gap-1 absolute top-0 end-0 bg-base-200 border border-neutral-500/20 shadow rounded z-50",children:[e.jsx("div",{className:"absolute top-1 end-2",children:e.jsx(r,{variant:"ghost",size:"small",onClick:()=>l(null),toolTipText:"Close the menu.",type:"button",children:e.jsx(_,{})})}),e.jsx("div",{className:"flex flex-col items-stretch",children:R.map(a=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"my-1",children:[e.jsx(z,{htmlFor:a.id,label:a.label,className:" font-semibold"}),e.jsxs("div",{className:"grid grid-cols-2 items-center",children:[o===a.id?e.jsx(S,{value:s.stats[a.id],onChange:j=>u(s.trace_id,a.id,j.target.value),size:"xs",className:"w-40",...a}):e.jsx("p",{className:"text-sm w-40  font-light",children:s.stats[a.id]}),!a.readOnly&&(o===a.id?e.jsx(r,{variant:"ghost",size:"extra-small",onClick:()=>t(null),children:e.jsx(Z,{})}):e.jsx(r,{variant:"ghost",size:"extra-small",onClick:()=>t(a.id),toolTipText:`Update ${a.label}`,children:e.jsx(G,{})}))]})]},a.id),e.jsx("hr",{className:"border-neutral-500/50 my-2 w-full"})]}))}),e.jsx("p",{className:"text-sm text-center my-1",children:'Elements with "*" are readonly'})]})})}function W({traces:l,handleFileUpload:i,handleDownloadFile:d}){return e.jsxs(e.Fragment,{children:[e.jsxs(r,{onClick:i,variant:"ghost",size:"small",toolTipText:"Upload a seismic file",children:[e.jsx(k,{}),"Upload file"]}),e.jsxs(r,{variant:"ghost",size:"small",onClick:()=>d("mseed",l,l[0].stats.record_name+"_download"),disabled:l?l.length===0:!1,toolTipText:"Download the updated traces to MiniSEED file format",children:["Download to MSEED",e.jsx(P,{})]})]})}function J({traces:l,backupTraces:i,setTraces:d,setBackupTraces:n,setError:v,setSuccess:x,setLoading:h,handleDownloadFile:p}){const[f,o]=m.useState(null);function t(s){o(f===s?null:s)}function u(s){const a=l.filter(j=>j.trace_id!==s);d(a),n(a)}return e.jsx(e.Fragment,{children:l.map((s,a)=>e.jsxs("div",{className:"h-1/3 relative",children:[e.jsxs("div",{className:"flex flex-row justify-end items-center gap-2",children:[e.jsx(r,{variant:"ghost",size:"small",onClick:()=>t(a),toolTipText:"Open the trace header menu. Feel free to update the fields.",children:e.jsx(V,{})}),e.jsx(r,{variant:"ghost",size:"small",onClick:()=>p("json",s.stats,s.stats.record_name+"_header"),toolTipText:"Download the header information of updated traces in a json format",children:e.jsx(H,{})}),e.jsx(r,{variant:"ghost",size:"small",onClick:()=>p("json",{record:s.stats.record_name,component:s.stats.component,data:s.ydata},s.stats.record_name+"_data"),toolTipText:"Download the data values of the traces in a json file format",children:e.jsx(q,{})}),e.jsx(r,{variant:"ghost",size:"small",onClick:()=>u(s.trace_id),toolTipText:"Remove trace.",className:"text-error",children:e.jsx(B,{})})]}),f===a&&e.jsx(Q,{setActivatedMenuIndex:o,traces:l,backupTraces:i,setTraces:d,setBackupTraces:n,setError:v,setSuccess:x,setLoading:h,traceId:s.trace_id}),e.jsx(O,{xData:[s.xdata],yData:[s.ydata],height:"220px",legendTitle:[`Component: ${s.stats.component}`],showGraphTitle:a===0,graphTitle:""})]},s.trace_id))})}function ie(){const[l,i]=m.useState([]),[d,n]=m.useState(null),[v,x]=m.useState(!1),[h,p]=m.useState([]),[f,o]=m.useState([]),[t,u]=m.useState(!1),[s,a]=m.useState({skip_rows:0,column_index:1,station:"",component:"",start_date:"1970-01-01",start_time:"00:00:00",sampling_rate:2}),j=m.useRef();async function y(c,N){c.preventDefault();const g=new FormData;g.append("file",c.target.files[0]);const T=await M({endpoint:D[N],setError:i,setSuccess:n,setLoading:x,method:"POST",data:g,successMessage:"The file has been succesfully uploaded!"});p(T),o(T)}async function b(c,N){c.preventDefault();const g=new FormData;g.append("file",c.target.files[0]),Object.keys(s).forEach(C=>{g.append(C,s[C])});const T=await M({endpoint:D[N],setError:i,setSuccess:n,setLoading:x,method:"POST",data:g,successMessage:"The file has been succesfully uploaded!"});p([T,...h]),o([T,...h])}function w(c){c.preventDefault(),j.current.click()}async function L(c,N,g){const T=await M({endpoint:D["DOWNLOAD-FILE"],setError:i,setSuccess:n,setLoading:x,method:"POST",data:{data:N,file_type:c},returnType:"blob"}),C=window.URL.createObjectURL(T);E(C,g+"."+c)}return e.jsxs(e.Fragment,{children:[l.length!==0&&e.jsx(U,{setError:i,setSuccess:n,type:"error",text:l}),d&&e.jsx(U,{setError:i,setSuccess:n,type:"success",text:d}),e.jsx("input",{ref:j,name:"file",type:"file",onChange:c=>y(c,"UPLOAD-SEISMIC-FILE"),hidden:!0}),e.jsxs("div",{className:"h-screen min-h-96",children:[e.jsx("div",{className:"border border-neutral-500/20 rounded-t-lg bg-base-200 p-3 flex flex-row items-center justify-start",children:e.jsx(W,{traces:h,handleFileUpload:w,handleDownloadFile:L})}),e.jsx("div",{className:"border border-neutral-500/20 h-2/3 overflow-y-scroll p-4 relative",children:h.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 absolute top-1/2 start-1/2 -translate-x-1/2 -translate-y-1/2",children:[e.jsx("h1",{className:"text-4xl",children:"Upload a seismic file"}),e.jsx("p",{className:"text-lg",children:"Start by uploading a seismic file to interact with the tool"}),e.jsxs(r,{onClick:w,toolTipText:"Upload a seismic file",loading:v,children:[e.jsx(k,{}),"Upload file"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(r,{onClick:()=>u(!t),size:"extra-small",variant:"ghost",toolTipText:"Upload a seismic file",children:"Add trace +"}),t&&e.jsx($,{setActivatedNewTraceMenu:u,newTraceOptions:s,setNewTraceOptions:a,handleFileSelection2:b})]}),e.jsx(J,{traces:h,backupTraces:f,setTraces:p,setBackupTraces:o,setError:i,setSuccess:n,setLoading:x,handleDownloadFile:L})]})})]})]})}export{ie as default};
